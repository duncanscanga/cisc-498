{% extends 'base.html' %}

{% block header %}
<h1>{% block title %}AutoGrader Result{% endblock %}</h1>
{% endblock %}

{% block content %}
<link rel="stylesheet" href="../static/styles/user_details.css" />

<div class="container">
  <h1>AutoGrader Result: {{ student.username }} ({{ student.student_number }})</h1>
  <div id="submissions">
    <h2>Test Case Results:</h2>
    <h3>{{score}} / {{totalScore}}</h3>
    <ul>
      <li> Late Penalty: {{ latePenalty }} % off </li>
      {% for result in submissionResults %}
      <li>
        Test Case: {{ result.testCaseId }}
        <br>
        Score: {{ result.score }} / {{ result.maxScore }}
        <br>
        Notes: {{ result.notes | replace("\n", "<br>") | safe }}
        <br>
        {% if result.type == "Output Comparison" and user.role in [2, 3] %}
          <form action="{{ url_for('update_grade', assignment_id=assignment.id, submission_id=result.submissionId, result_id=result.id) }}" method="post">
            <div class="form-group">
              <label for="adjust_score_{{result.id}}">Adjust Score:</label>
              <input type="number" class="form-control" id="adjust_score_{{result.id}}" name="adjust_score" value="{{ result.score }}">
            </div>
            <div class="form-group">
              <label for="comments_{{result.id}}">Comments:</label>
              <textarea class="form-control" id="comments_{{result.id}}" name="comments">{{ result.taComment }}</textarea>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="approve_{{result.id}}" name="approve" {% if result.approved %}checked{% endif %}>
              <label class="form-check-label" for="approve_{{result.id}}">Approve</label>
            </div>
            <button type="submit" class="btn btn-primary">Update Grade</button>
          </form>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}
