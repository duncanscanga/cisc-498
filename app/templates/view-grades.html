{% extends 'base.html' %}

{% block header %}
<h1>{% block title %}AutoGrader Result{% endblock %}</h1>
{% endblock %}

{% block content %}
<link rel="stylesheet" href="../static/styles/user_details.css" />

<div class="container my-3">
  <h1>AutoGrader Result: {{ student.username }} ({{ student.student_number }})</h1>
  <h3>{{score}} / {{totalScore}} with {{ submission.manualLateMarks }} late marks off</h3>

  <div class="row">
    {% for result in submissionResults %}
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">{{ result.testCaseName }} ({{ result.testCaseType }})</h5>
          <h6 class="card-subtitle mb-2 text-muted">Score: {{ result.score }} / {{ result.maxScore }}</h6>
          {% if result.notes %}
          <p class="card-text">{{ result.notes | replace("\n", "<br>") | safe }}</p>
          {% endif %}
          {% if result.taComment %}
          <p class="card-text"><strong>TA Comments:</strong> {{ result.taComment | replace("\n", "<br>") | safe }}</p>
          {% endif %}
          <!-- Your Output and Expected Output goes here if necessary -->


        {% if result.type == "Output Comparison" %}
        {% if result.score != result.maxScore %}
          <p><strong>Your Output (Up to Divergence):</strong></p>
          {{ result.preErrorOutput | safe }}
          {% if result.errorChar %}
            <span style="background-color: yellow;">{{ result.errorChar | safe }}</span>
            {{ result.postErrorOutput | safe }}
            <br>
            <strong>Expected (Starting from Divergence):</strong>
            {{ result.expectedPreError | safe }}
            <span style="background-color: lightgreen;">{{ result.expectedErrorChar | safe }}</span>
            {{ result.expectedPostError | safe }}
          {% endif %}
        {% else %}
          <p></p>
        {% endif %}
      {% elif result.score != result.maxScore %}
        <p><strong>Your Output:</strong></p>
        {{ result.codeOutput | safe }}
        <p><strong>Expected Output:</strong></p>
        {{ result.expectedOutput | safe }}
      {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
